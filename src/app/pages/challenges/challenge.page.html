<ion-header>
    <ion-toolbar>
        <ion-title>Habits</ion-title>
        <ion-buttons slot="start">
            <ion-back-button class="text-button" defaultHref="/tabs/home"></ion-back-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-row id="viewPicker">
    <ion-col style="padding: 0">
        <ion-buttons id="allChallenges" class="text-button selected" style="justify-content: center">
            <ion-button style="text-align: center">
                <ion-button class="text-button" (click)="this.challengeView = 'all'"> All Challenges</ion-button>
            </ion-button>
        </ion-buttons>
    </ion-col>
    <ion-col style="padding: 0">
        <ion-buttons id="myChallenges" class="text-button" style="justify-content: center">
            <ion-button style="text-align: center">
                <ion-button class="text-button" (click)="this.challengeView = 'joined'"> My Challenges</ion-button>
            </ion-button>
        </ion-buttons>
    </ion-col>
</ion-row>

<ion-content *ngIf="challengeView == 'all'">
    <ion-list>
        <ng-container *ngFor="let type of ( types | async )">
            <ion-card (click)="challengeView = type.type">
                <ion-card-title class="ion-padding">{{type.type}}</ion-card-title>
                <ion-card-content style="padding:0"><img src="{{type.picture}}"></ion-card-content>
            </ion-card>
        </ng-container>
    </ion-list>
</ion-content>

<ion-content *ngIf="challengeView == 'joined'">
    <ion-list>
        <ng-container *ngFor="let challenge of ( challenges | async )">
            <ion-card *ngIf="challengeJoined(challenge.id)" [ngClass]="challenge.id" (click)="expandCard(challenge.id)">
                <ion-card-title class="ion-padding">{{challenge.title}}</ion-card-title>
                <ion-card-subtitle class="ion-padding ion-hide">{{challenge.description}}"</ion-card-subtitle>
                <ion-card-content class="ion-hide" style="padding: 0">
                    <ion-list>
                        <ion-item *ngFor="let day of challenge.contents">{{day.title}}</ion-item>
                    </ion-list>
                    <ion-row style="background-color: var(--ion-color-danger); font-size: 1.5em; color: white">
                        <ion-col class="ion-text-center" (click)="quitChallenge(challenge.id)">QUIT</ion-col>
                    </ion-row>
                </ion-card-content>
            </ion-card>
        </ng-container>
    </ion-list>
</ion-content>

<ion-content *ngIf="challengeView != 'all' && challengeView != 'joined'">
    <ion-list>
        <ng-container *ngFor="let challenge of ( challenges | async )">
            <ion-card button [routerLink]="['/habit', challenge.id]" *ngIf="challenge.type == challengeView" [ngClass]="challenge.id">
                <ion-card-title class="ion-padding">{{challenge.title}}</ion-card-title>
            </ion-card>
        </ng-container>
        <ion-card style="background-color: var(--main-color)" (click)="challengeView = 'all'">
            <ion-card-title class="ion-padding">View Categories</ion-card-title>
        </ion-card>
    </ion-list>
</ion-content>

