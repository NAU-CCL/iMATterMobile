This will have two purposes:
1. Describing the basic steps to get a new version of iMATter onto the Google play store
2. A list of gotchas that plagued the first attempt to upload to google play

Uploading iMATter to Google play
0. Add new splash to the loading screen. This can be done via the instructions found int the "Team-ReBoot.-Final-as-build-report.docx"

1. Ensure the config is targeting the correct SDK version. As of 2022, SDK 32 must be tartgeted, but by Aug. 2023, SDK 33 must be. 
    a. This can be checked in the  'config.xml' file, in the preference tag: "android-targetSdkVersion"
    b. If you had to change this, you will have to update the android platform with: 
        $ cordova platform remove android
        followed by:
        $ cordova platform add android
    c. You may need to add the following to platforms/android/app/build.gradle:
        android{
            # what is already here
            ... 

            # add the following:
            defaultTargetSdkVersion = 32 # the newest android platform
        }
    d. ensure you have the platform tools required. If in a directory where you can use sdkmanager, run:
        $ sdkmanager --install "platform-tools" "platforms;android-{number of the android platform}"
        and to ensure the build tools are there, go to https://developer.android.com/studio/releases/build-tools and find the newest version. Then:
        $ sdkmanager --install "build-tools;{the newest version}"
2. If the android platform is not installed, install in the project root with:
    $ cordova platform add android
3. The gradlew wrapper:
    gradlew is a wrapper over the gradle function, allowing specific build tools that were used previously to be used in the present, regardless of the current build tools
    More about the gradle wrapper can be found at https://docs.gradle.org/current/userguide/gradle_wrapper.html
    Importantly, note that the wrapper should be used unless that build does not allow for upload to google play ( a new platform is required )
4. You need a new gradle: 
    If you are upgrading to a new platform, or just are doing a fresh install, you will need a new gradle wrapper. This can be generated by
    running the following command in the project root:
    $ ionic cordova build android
5. After you generate a gradlew file, do:
    $ cd platforms/android
    then, if using linux, run:
    ./gradlew bundle
    or on windows:
    gradlew.bat
    or on mac:
    gradle bundle

This will generate the .aab file needed to upload to the Google Play Store, but we still need to sign it 

6. Sign the .aab 
    Make sure jarsigner is in your path, then run:
    $ jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore platforms/android/app/build/outputs/bundle/release/app-release.aab alias_name
    This looks like an incorrect command, but don't change it, otherwise it won't work
    Then just put in the password for the key, then it signs it. Almost done 

7. Rename the new .aab: 
    The older version of the .aab can be moved into the older releases folder, and the new version needs to be moved into the main directory for clarity.
    In the project root directory, run, replacing with the actual version of the release:
    $ cp platforms/android/app/build/outputs/bundle/release/app-release.aab ./iMATter_VX.X.X.aab 

8. Navigate to the Google Play Development console and on the sidebar, click app bundle explorer. In the top right, click, upload new bundle, then upload the newly copied file.
    Done!

Gotchas: This is an expanding list of things that have gone wrong in the past in order to not mess these up in the future

Apply Plugin Problems:
The specifics: There was a plugin being added to the build.gradle called GradlePluginGoogleServices, which was stuck on a bugged version, 4.3.8. 
               Cordova was not properly using version control to ignore these older versions and was still erroring.
Solution: The config.xml has a method to enforce version control, which can be done with any plugin causing issues. The format is:
              <preference name="GradlePluginGoogleServicesVersion" value="4.3.14" />

AndroidManifest.xml problems:
The specifics: An error kept appearing that there was a duplicated element in the AndroidManifest.xml file. Specifically, the default_notification_channel_id.

Solution: It would seem like deleting the duplicate line would solve the problem, but the manifest file is actually auto generated, which means that any 
          edits to the file are overwritten on next build attempt. The Hacky solution is to find the plugins in the plugins folder which have the same 
          element listed in their dependencies. Then, in the android.json, look for the same value and comment it out too. Then the next time you build,
          there should no longer be the duplicate. However, this regresses whenver the plugin updates and will require these steps to be repeated.

Real Solution: 

Android API: Google play will not accept app bundles with the wrong app bundle api being targeted. Thus, in the config.xml file, there is a target for 
             the desired API. This must be changed to the wanted API, currently 32.

Permissions Plugins: For some reason one of the plugins for cordova has the permission "REQUEST_INSTALL_PACKAGES" which is not allowed by the Google Play store
                     As it could cause abuse. So it has to be edited in the AndroidManifest.xml. Change:
                         <uses-permission android:name="android.permission.REQUEST_INSTALL_PACKAGES" />
                     To:
                         <uses-permission android:name="android.permission.REQUEST_INSTALL_PACKAGES" tools:node="remove"/>
