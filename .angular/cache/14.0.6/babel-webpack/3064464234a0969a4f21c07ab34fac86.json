{"ast":null,"code":"var _a;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { AlertController, LoadingController, ToastController } from '@ionic/angular';\nimport { AuthServiceProvider } from '../../../services/user/auth.service';\nimport { Router } from '@angular/router';\nimport { AngularFirestore } from '@angular/fire/firestore';\nlet CodePage = class CodePage {\n  constructor(loadingCtrl, alertCtrl, authService, router, formBuilder, afs, toastCtrl) {\n    this.loadingCtrl = loadingCtrl;\n    this.alertCtrl = alertCtrl;\n    this.authService = authService;\n    this.router = router;\n    this.formBuilder = formBuilder;\n    this.afs = afs;\n    this.toastCtrl = toastCtrl;\n    this.codeForm = this.formBuilder.group({\n      code: ['', Validators.compose([Validators.required])]\n    });\n  }\n\n  ngOnInit() {}\n\n  validateCode(code) {\n    const docRef = this.afs.firestore.collection('users').doc(code);\n    docRef.get().then(docData => {\n      if (docData.exists && docData.get('codeEntered') === false) {\n        console.log('Exists');\n        this.codeValidated = true;\n        this.afs.firestore.collection('users').doc(code).update({\n          codeEntered: true\n        }).then(value => value);\n        this.router.navigate(['/signup/', code]).then(value => value);\n      } else if (docData.get('codeEntered') === true) {\n        this.showToast('Code already used');\n        this.codeValidated = false;\n      } else {\n        console.log('No such document!');\n        this.showToast('Code does not exist');\n        this.codeValidated = false;\n      }\n    }).catch(err => {\n      console.log('Error getting document', err);\n    });\n  }\n\n  showToast(msg) {\n    this.toastCtrl.create({\n      message: msg,\n      duration: 2000\n    }).then(toast => toast.present());\n  }\n\n};\nCodePage = __decorate([Component({\n  selector: 'app-code',\n  templateUrl: './code.page.html',\n  styleUrls: ['./code.page.scss']\n}), __metadata(\"design:paramtypes\", [LoadingController, AlertController, AuthServiceProvider, Router, FormBuilder, typeof (_a = typeof AngularFirestore !== \"undefined\" && AngularFirestore) === \"function\" ? _a : Object, ToastController])], CodePage);\nexport { CodePage };","map":null,"metadata":{},"sourceType":"module"}